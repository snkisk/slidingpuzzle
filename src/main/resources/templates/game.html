<!DOCTYPE html>
<html lang=“ja”>
  <head>
    <meta charset=“UFT-8”>
    <title>CSS</title>
    <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
  </head>
  <body>
<style>
  .container {
    display: flex;
    flex-wrap: wrap;
    margin: 5% 30%;
  }
  .container .inner {
    position: relative;
  }
  .container .inner::before {
    content: "";
    display: block;
    padding-top: 100%;
  }
  .container .inner span {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    text-align: center;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .container .inner span.current:after {
    content: '〇';
  }

  .container .inner:nth-child(even) span {
    background-color: #eee;
  }
  .container .inner span.block {
    background: url('/image/wall.png') center center /cover no-repeat;
  }
  .container .inner span.start:before {
    content: 'start';
    position: absolute;
    color: #eee;
    text-shadow: 1px 1px 0 #000, -1px 1px 0 #000, 1px -1px 0 #000, -1px -1px 0 #000;
    opacity: 0.2;
  }
  .container .inner span.goal:before {
    content: 'goal';
    position: absolute;
    color: #eee;
    text-shadow: 1px 1px 0 #000, -1px 1px 0 #000, 1px -1px 0 #000, -1px -1px 0 #000;
    opacity: 0.2;
  }

  @media only screen and (max-width: 980px) {
    /* スマホ */
    .container {
      margin: initial;
    }
  }
</style>

<style th:text="|
  .container .inner {
    flex: 0 0 ${flexSize}%;
  }
  .container .inner:nth-child(-n + ${#lists.size(cells)}) span {
    border-top: solid 0.1px #808080;
  }
  .container .inner:nth-child(${#lists.size(cells)}n) span {
    border-right: solid 0.1px #808080;
  }
  .container .inner:nth-child(${#lists.size(cells)}n - ${#lists.size(cells) - 1}) span {
    border-left: solid 0.1px #808080;
  }
  .container .inner:nth-child(${#lists.size(cells)}n - ${#lists.size(cells) - 1}) span {
    border-left: solid 0.1px #808080;
  }
  .container .inner:nth-child(n + ${#lists.size(cells) * (#lists.size(cells) - 1) + 1}) span {
    border-bottom: solid 0.1px #808080;
  }
|"></style>

<div class="container">
  <th:block th:each="row, i: ${cells}">
    <th:block th:each="class, j: ${row}">
      <div class="inner">
        <th:block th:switch="true">
          <span th:id="|${i.count}${j.count}|" th:class="${class}"></span>
        </th:block>
      </div>
    </th:block>
  </th:block>
</div>

<!--
<div class="container">
  <div class="inner"><span id=11></span></div>
  <div class="inner"><span id=12></span></div>
  <div class="inner"><span id=13></span></div>
  <div class="inner"><span id=14></span></div>
  <div class="inner"><span id=15 class="goal"></span></div>
  <div class="inner"><span id=21></span></div>
  <div class="inner"><span id=22></span></div>
  <div class="inner"><span id=23></span></div>
  <div class="inner"><span id=24></span></div>
  <div class="inner"><span id=25></span></div>
  <div class="inner"><span id=31></span></div>
  <div class="inner"><span id=32></span></div>
  <div class="inner"><span id=33></span></div>
  <div class="inner"><span id=34></span></div>
  <div class="inner"><span id=35></span></div>
  <div class="inner"><span id=41 class="block"></span></div>
  <div class="inner"><span id=42></span></div>
  <div class="inner"><span id=43></span></div>
  <div class="inner"><span id=44></span></div>
  <div class="inner"><span id=45></span></div>
  <div class="inner"><span id=51 class="start"></span></div>
  <div class="inner"><span id=52></span></div>
  <div class="inner"><span id=53></span></div>
  <div class="inner"><span id=54></span></div>
  <div class="inner"><span id=55></span></div>
</div>
-->

  <div id="message"></div>
  <div id="message2"></div>

<script>
  $(function () {
    alert('ゲームスタート');

    $(window).keydown(function (e) {
      if (! [37, 38, 39, 40].includes(e.keyCode)) {
        return false;
      }

      console.log($('.container > .inner > span.goal:contains("〇")'));
      if ($('.container > .inner > span.goal:contains("〇")').length) {
        // 〇のあるマスにclass="goal"がある場合.
        alert('ゲームクリア');
      }
    });
  });
</script>
  
<script>

document.onkeydown = keydown

var player=53;
var KC=0;
function keydown() {
       target = document.getElementById("message");
        target.innerHTML = "キーが押されました KeyCode :" + event.keyCode;
   KC=event.keyCode;
   if(KC==38){
     target = document.getElementById("message2");
     target.innerHTML = "上";
  while(player>=21){
    if(player==51){
      
      break;
      }else{
	player=player-10;
      target=document.getElementById(player)
  target.innerHTML = '〇'
     target=document.getElementById(player+10)
  target.innerHTML = ''
}
   }
   }else if(KC==39){
     target = document.getElementById("message2");
     target.innerHTML = "右";
  while(player%10!=5){
	player=player+1;
    
      target=document.getElementById(player)
  target.innerHTML = '〇'
     target=document.getElementById(player-1)
  target.innerHTML = ''

   }
   }else if(KC==40){
     target = document.getElementById("message2");
     target.innerHTML = "下";
  while(player<=45){
    if(player==31){
      
    break;
    }else{
	player=player+10;
  target=document.getElementById(player)
  target.innerHTML = '〇'
     target=document.getElementById(player-10)
  target.innerHTML = ''
    }
  }   

   }else if(KC==37){
     target = document.getElementById("message2");
     target.innerHTML = "左"; 
  while(player%10!=1){
	player=player-1;
    target=document.getElementById(player)
  target.innerHTML = '〇'
     target=document.getElementById(player+1)
  target.innerHTML = ''
  
   }
   }else{
     target = document.getElementById("message2");
     target.innerHTML = "";
   }

 }
  </script>
</body>